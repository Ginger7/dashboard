<!doctype html>
<html class="no-js" lang="ru">

    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Главная</title>
        <meta content="" name="description">
        <meta content="" name="keywords">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <meta content="telephone=no" name="format-detection">
        <!-- This make sence for mobile browsers. It means, that content has been optimized for mobile browsers -->
        <meta name="HandheldFriendly" content="true">

        <meta property="og:title" content="" />
        <meta property="og:url" content="" />
        <meta property="og:description" content="" />
        <meta property="og:image" content="" />
        <meta property="og:image:type" content="image/jpeg" />
        <meta property="og:image:width" content="500" />
        <meta property="og:image:height" content="300" />
        <meta property="twitter:description" content="" />
        <link rel="image_src" href="" />

        <link rel="icon" type="image/x-icon" href="favicon.ico">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">
        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
        <meta name="msapplication-TileColor" content="#0458fe">
        <meta name="theme-color" content="#ffffff">

        <!-- Google Fonts -->
        <link href="https://fonts.gstatic.com" rel="preconnect">
        <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@200;400;500;600;700&family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
        <!-- end Google Fonts -->

        <link href="https://cdn.jsdelivr.net" rel="preconnect">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
        <link rel="stylesheet" href="static/css/separate-css/jquery.flexdatalist.min.css">
        <!--[if IE 8 ]>
    <link href="static/css/main_ie8.min.css" rel="stylesheet" type="text/css"><![endif]-->
        <!--[if IE 9 ]>
    <link href="static/css/main_ie9.min.css" rel="stylesheet" type="text/css"><![endif]-->
        <!--[if (gt IE 9)|!(IE)]><!-->
        <link href="static/css/main.css" rel="stylesheet" type="text/css">
        <!--<![endif]-->

        <!-- JQuery CDN -->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <!-- end JQuery CDN -->

        <script src="static/js/separate-js/jquery.flexdatalist.min.js"></script>
        <!-- Vue.js -->
        <script src="https://cdn.jsdelivr.net/npm/vue@2.6/dist/vue.min.js"></script>
        <!-- end Vue.js -->

        <!-- Chart.js -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
        <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script> -->
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
        <!-- <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0"></script> -->
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/0.5.7/chartjs-plugin-annotation.js"></script> -->
        <!-- end Chart.js -->

        <script>
            (function (H) {
                H.className = H.className.replace(/\bno-js\b/, 'js')
            })(document.documentElement)
        </script>
        <!--[if lt IE 9 ]>
    <script src="static/js/separate-js/html5shiv-3.7.2.min.js" type="text/javascript"></script>
    <meta content="no" http-equiv="imagetoolbar"><![endif]-->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
        <link rel="stylesheet" href="https:/cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
        <script src="https:/cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartist-plugin-pointlabels@0.0.6/dist/chartist-plugin-pointlabels.min.js"></script>
    </head>

    <body>

        <div class="page">

            <header class="page_hdr header container-fluid">
                <div class="page-hdr_grid">
                    <div class="hdr-menu">
                        <div class="burder-logo">
                            <div class="menu-wrapper">
                                <a class="m-href" href="#">
                                    <img src="static/img/general/h-logo.svg" alt="" width="254">
                                </a>
                            </div>
                            <div class="header-burger">
                                <span></span>
                            </div>
                        </div>
                        <div class="header-menu">
                            <nav>
                                <ul class="header-list">
                                    <li>
                                        <a href="/">Венчурные инвестиции</a>
                                    </li>
                                    <li>
                                        <a href="/exits/">Выходы</a>
                                    </li>
                                    <li>
                                        <a href="/startups/">Таблица сделок</a>
                                    </li>
                                    <li>
                                        <a href="/investments/">Направления инвестиций</a>
                                    </li>
                                    <li>
                                        <a href="/startups/">ESG</a>
                                    </li>
                                    <li>
                                        <a href="/startups/">Аналитические исследования</a>
                                    </li>
                                    <li>
                                        <a href="/about/">О проекте</a>
                                    </li>
                                </ul>
                            </nav>
                            <div class="burger-logo">
                                <a href="#">
                                    <img src="static/img/general/aim-white.svg" alt="" width="122">
                                </a>
                                <a href="#">
                                    <img src="static/img/general/dsight-white.svg" alt="" width="135">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hdr-search" id="hdr-search">
                        <form class="input-group">
                            <input type='text' class="header-search form-control" placeholder='Найти компанию или инвестора' list='search' name='search' aria-describedby="search-btn">
                            <button id="search-btn" type="submit"></button>
                        </form>
                    </div>
                    <div class="hdr-lang">
                        <span class="hdr-lang__item active">RU</span>
                        <a href="#" class="hdr-lang__item">EN</a>
                    </div>

                    <div class="hdr-logos">
                        <div class="logo-wrapper">
                            <img src="static/img/general/aim.svg" alt="" width="122">
                        </div>
                        <div class="logo-wrapper">
                            <img src="static/img/general/dsight-white.svg" alt="" width="135">
                        </div>
                    </div>
                </div>
                <script>
                    $(document).ready(function(){
                        $('.header-burger').click(function(event){
                            $('.header-burger, .header-menu').toggleClass('active');
                            $('body').toggleClass('lock');
                        });
                    });
                    $(function () {
                        /* пример файла выдачи  http://projects.sergiodinislopes.pt/flexdatalist/countries.json?relatives%5Bcountry_toggle_multiple_values%5D=166%2C149&selected=&original=&keyword=%3Bkl&contain=false */
                        $('.header-search').flexdatalist({
                            limitOfValues: 10,
                            minLength: 1,
                            searchIn: 'name',
                            valueProperty: '*',
                            selectionRequired: true,
                            //url: "/ajax/header-search/",
                            url: "countries.json",
                            searchByWord: true,
                            noResultsText: '<div class="flexdatalist-noresults">Ничего не найдено</div>',
                        })
                    })
                </script>
            </header>

            <main class="page_main container-fluid">
                <div class="main-grid">
                    <div class="left-menu">
                        <div class="left-menu">
                            <div class="menu-wrap">
                                <ul class="menu">
                                    <li class="menu-item">
                                        <a class="menu-item-href" href="/">
                                            <svg width="32" height="31" viewBox="0 0 32 31" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M31 11.15V6C31 3.23858 28.7614 1 26 1H6C3.23858 1 1 3.23858 1 6V11.15M31 11.15V25C31 27.7614 28.7614 30 26 30H11M31 11.15H11M1 11.15V25C1 27.7614 3.23858 30 6 30H11M1 11.15H11M11 11.15V30" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                            </svg>
                                        </a> <span>Венчурные инвестиции</span>
                                    </li>
                                    <li class="menu-item">
                                        <a class="menu-item-href" href="/exits/">
                                            <svg width="32" height="31" viewBox="0 0 27 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M4 5L23 5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                <path d="M1 13L16 13" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                <path d="M9 21L24 21" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                <path d="M21 1.5L24.5 5L21 8.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                <path d="M13 9.5L16.5 13L13 16.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                <path d="M22 17.5L25.5 21L22 24.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                            </svg>
                                        </a> <span>Выходы</span>
                                    </li>
                                    <li class="menu-item">
                                        <a class="menu-item-href" href="/startups/">
                                            <svg width="32" height="31" viewBox="0 0 32 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M31 1.31384H11M1 1.31384H4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                <path d="M31 11.1328H11M1 11.1328H4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                <path d="M31 20.9517H11M1 20.9517H4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                            </svg>
                                        </a> <span>Таблица сделок</span>
                                    </li>
                                    <li class="menu-item">
                                        <a class="menu-item-href" href="/investments/">
                                            <svg width="32" height="31" viewBox="0 0 35 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <rect x="1.49121" y="1.72607" width="16.7887" height="16.7887" rx="5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect>
                                                <path d="M33.1865 21.7261H26.4912C23.7298 21.7261 21.4912 23.9647 21.4912 26.7261V33.3682" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                <rect x="8.49121" y="8.72607" width="24.7887" height="24.7887" rx="5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect>
                                            </svg>
                                        </a> <span>направления инвестиций</span>
                                    </li>
                                    <li class="menu-item">
                                        <a class="menu-item-href active" href="/startups/">
                                    ESG
                                </a>
                                        <span>ESG</span>
                                    </li>
                                    <li class="menu-item">
                                        <a class="menu-item-href" href="/startups/">
                                            <svg width="39" height="26" viewBox="0 0 39 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M3.50958 22.8053L15.0555 11.2594L21.5814 17.7853L36.1393 3.22748" stroke="#6D798F" stroke-width="2" />
                                                <circle cx="3.58216" cy="22.4645" r="2.40271" fill="#F2F3F6" stroke="#6D798F" stroke-width="2" />
                                                <circle cx="15.0973" cy="11.2296" r="2.40271" fill="#F2F3F6" stroke="#6D798F" stroke-width="2" />
                                                <circle cx="21.9027" cy="17.4767" r="2.40271" fill="#F2F3F6" stroke="#6D798F" stroke-width="2" />
                                                <circle cx="35.5012" cy="3.76856" r="2.40271" fill="#F2F3F6" stroke="#6D798F" stroke-width="2" />
                                            </svg>
                                        </a>
                                        <span>АНАЛИТИКА</span>
                                    </li>
                                    <li class="menu-item">
                                        <a class="menu-item-href" href="/about/" style="height: 69px; padding-top: 28px; width: 72px;">?</a>
                                        <span>О проекте</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="main-grid-right">
                        <div class="title">Венчурные инвестиции<span class="ml-3">Главная</span>
                        </div>
                        <div class="invest-container">
                            <div class="invest__grid">
                                <div class="right-invest">
                                    <div class="january-container">
                                        <button class="click-list">
                                            <i class="fas fa-chevron-down"></i>
                                        </button>
                                        <button class="click-list close">
                                            <img src="static/img/content/deals/close-button.svg" alt="">
                                        </button>

                                        <div class="years-list first">
                                            <div class="period">
                                                <div class="list-title">Год</div>
                                                <div class="list-year">
                                                    <select class="y selectpicker selectpicker-year" id="year">
                                                        <option value="2020" selected>2020</option>
                                                        <option value="2019">2019</option>
                                                        <option value="2018">2018</option>
                                                        <option value="2017">2017</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="period">
                                                <div class="list-title">Период</div>
                                                <div class="list-year">
                                                    <select class="y selectpicker selectpicker-year" id="quarter">
                                                        <option value="1">&#8544; квартал</option>
                                                        <option value="2">&#8545; квартал</option>
                                                        <option value="3">&#8546; квартал</option>
                                                        <option value="4" selected>&#8547; квартал</option>
                                                        <option value="0" selected>год</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="january-wrapper">
                                            <div class="january-block">
                                                <div class="main-title mb-1" id="quarterYear">Январь - март 2021</div>
                                                <style>
                                                    .ct-chart-line .ct-grids .ct-grid:nth-child(1) {
                                                    					transform: translate(0, 4.8780487804878px) !important;
                                                    				}
                                                    
                                                    				.ct-chart-line .ct-grids .ct-grid:nth-child(2) {
                                                    					transform: translate(0, 10.731707317073px) !important;
                                                    				}
                                                    
                                                    				.ct-chart-line .ct-grids .ct-grid:nth-child(3) {
                                                    					transform: translate(0, 40.487804878049px) !important;
                                                    				}
                                                    
                                                    				.ct-chart-line .ct-grids .ct-grid:last-child {
                                                    					transform: translate(0, 49.756097560976px) !important;
                                                    				}
                                                </style>
                                                <div class="invest-row">
                                                    <div class="investment">
                                                        <div class="money" id="all_money">
                                                            <!-- $1 000 000 -->
                                                            $120,6</div>
                                                        <div class="inv-text">
                                                            Объем инвестиций, млн
                                                        </div>
                                                    </div>
                                                    <div class="investment">
                                                        <div class="money" id="medium_money">
                                                            <!-- $1 500 -->
                                                            $3,8</div>
                                                        <div class="inv-text">
                                                            Средний размер сделки, млн
                                                        </div>
                                                    </div>
                                                    <div class="investment">
                                                        <div class="money" id="count_money">
                                                            <!-- 10 -->
                                                            32</div>
                                                        <div class="inv-text">
                                                            Количество сделок
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="period-block">
                                                <div class="main-title">
                                                    Доля Москвы в России
                                                </div>
                                                <div class="invest-row">
                                                    <div class="investment">
                                                        <div class="money" id="mockow_invest">
                                                            70%
                                                        </div>
                                                        <div class="inv-text">
                                                            по&nbsp;объему инвестиций
                                                        </div>
                                                    </div>
                                                    <div class="investment">
                                                        <div class="money" id="mockow_deal">
                                                            63%
                                                        </div>
                                                        <div class="inv-text">
                                                            по&nbsp;количеству сделок
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="period-block">
                                                <div class="main-title">
                                                    Прирост по сравнению с аналогичным периодом предыдущего года
                                                </div>
                                                <div class="invest-row">
                                                    <div class="investment">
                                                        <div class="money" id="prirost_invest">
                                                            -37 %
                                                        </div>
                                                        <div class="inv-text">
                                                            Объем инвестиций
                                                        </div>
                                                    </div>
                                                    <div class="investment">
                                                        <div class="money" id="prirost_deal">
                                                            -14 %
                                                        </div>
                                                        <div class="inv-text">
                                                            Количество сделок
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="period-block mb-0">
                                                <div class="main-title mw">
                                                    Распределение объема инвестиций
                                                </div>
                                                <div class="investments-wrapper">
                                                    <div class="invest-wrapper">
                                                        <div class="inv bg-lblue">
                                                            <figure class="inv-img">
                                                                <img src="static/img/general/globus.svg" alt="">
                                                                <img src="static/img/general/arrow.svg" alt="">
                                                            </figure>
                                                            <div class="inv-t">
                                                                <span class="bold-digit" id="in_invest">
                            								24%
                            							</span>
                                                                <span class="small-text">
                            								Иностранные инвестиции
                            							</span>
                                                            </div>
                                                        </div>
                                                        <div class="inv bg-blue">
                                                            <figure class="inv-img">
                                                                <img src="static/img/general/russia.svg" alt="">
                                                            </figure>
                                                            <div class="inv-t">
                                                                <span class="bold-digit" id="ros_invest">
                            								76%
                            							</span>
                                                                <span class="small-text">
                            								Российские инвестиции
                            							</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="invest-wrapper">
                                                        <div class="inv bg-pink">
                                                            <figure class="inv-img">
                                                                <img src="static/img/general/mail.svg" alt="">
                                                            </figure>
                                                            <div class="inv-t">
                                                                <span class="bold-digit" id="sum_deal">
                            								97%
                            							</span>
                                                                <span class="small-text">
                            								Сумма сделки известна
                            							</span>
                                                            </div>
                                                        </div>
                                                        <div class="inv bg-lblue second-bg">
                                                            <figure class="inv-img">
                                                                <img src="static/img/general/close-mail.svg" alt="">
                                                            </figure>
                                                            <div class="inv-t">
                                                                <span class="bold-digit" id="notsum_deal">
                            								3%
                            							</span>
                                                                <span class="small-text">
                            								Сумма сделки неизвестна
                            							</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <script>
                                        $(function (){
                                        console.log($("#in_invest").text().trim());
                                        	$("#in_invest").closest('.inv').css( 'height', $("#in_invest").text().trim() );
                                        	$("#ros_invest").closest('.inv').css( 'height', $("#ros_invest").text().trim() );
                                        	$("#sum_deal").closest('.inv').css( 'height', $("#sum_deal").text().trim() );
                                        	$("#notsum_deal").closest('.inv').css( 'height', $("#notsum_deal").text().trim() );
                                        });
                                    </script>
                                    <div class="deals-container">
                                        <button class="list-click">
                                            <i class="fas fa-chevron-down" aria-hidden="true"></i>
                                        </button>
                                        <button class="list-click close">
                                            <img src="/static/img/content/deals/close-button.svg" alt="">
                                        </button>

                                        <div class="years-list second">
                                            <div class="period">
                                                <div class="list-title">Год</div>
                                                <div class="list-year">
                                                    <select class="y selectpicker selectpicker-yeardeal" id="yeardeal">
                                                        <option value="20" selected>2020</option>
                                                        <option value="19">2019</option>
                                                        <option value="18">2018</option>
                                                        <option value="17">2017</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="period">
                                                <div class="list-title">Месяц</div>
                                                <div class="list-year">
                                                    <select class="y selectpicker selectpicker-yeardeal" id="monthdeal">
                                                        <option value="Jan" selected>Январь</option>
                                                        <option value="Feb">Февраль</option>
                                                        <option value="Mar">Март</option>
                                                        <option value="Apr">Апрель</option>
                                                        <option value="May">Май</option>
                                                        <option value="Jun">Июнь</option>
                                                        <option value="Jul">Июль</option>
                                                        <option value="Aug">Август</option>
                                                        <option value="Sep">Сентябрь</option>
                                                        <option value="Oct">Октябрь</option>
                                                        <option value="Nov">Ноябрь</option>
                                                        <option value="Dec">Декабрь</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="deals-wrapper">
                                            <div class="deals-title">
                                                <div class="main-title  pr-4">Сделки Месяца<span id="dealMonth">октябрь 2020</span>
                                                </div>
                                                <div class="deals-amount">
                                                    <div class="deals-amount__item"><span>354</span> сделки</div>
                                                    <div class="deals-amount__item"><span>$50,5</span> млн</div>
                                                </div>
                                            </div>
                                            <div class="table-deals">
                                                <div id="vueDealsTable">
                                                    <div class="thead">
                                                        <div class="row">
                                                            <div class="t-h">Проект,
                                                                <br>рыночная ниша
                                                            </div>
                                                            <div class="t-h">Инвестор</div>
                                                            <div class="t-h">Объем инвестиций, $ млн</div>
                                                        </div>
                                                    </div>
                                                    <div class="tbody">
                                                        <div class="row no-active" v-for="row in rows">
                                                            <div class="td-company">
                                                                <span v-html="row.company"></span>
                                                                <span class="subh" v-html="row.subheader"></span>
                                                            </div>
                                                            <div class="td-investor">
                                                                <div class="td-investor-wrapper">
                                                                    <div v-html="row.investor"></div>
                                                                    <div class="td-volume" v-html="row.volume"></div>
                                                                </div>
                                                                <div class="progressbar" v-bind:class="{'progressbar-1900': row.active1900, 'progressbar-1137': row.active1137, 'progressbar-679': row.active679, 'progressbar-517': row.active517}"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="button-wrapper">
                                                <a href="/site/startups" class="all-deal" style="padding: 10px 15px; color: #fff; background: #F20EB5; border-radius: 53px; font-size: 10px; font-weight: 500;">
                                            Все сделки
                                        </a>
                                            </div>
                                            <!-- <div class="button-wrapper">
                                                                                <a class="look-all" href="/site/startups">Все сделки</a>
                                                                        </div> -->
                                        </div>
                                    </div>
                                    <script>
                                        var companiesTable = new Vue({
                                            el: '#vueDealsTable',
                                            data: {
                                                rows: [
                                                    {
                                                        company: 'Cyber Legacy',
                                                        subheader: 'SportTech',
                                                        investor: 'Freedom International Group',
                                                        volume: 5.5,
                                                        active5500000: true
                                                    },
                                                    {
                                                        company: 'CarPrice',
                                                        subheader: 'E-commerce',
                                                        investor: 'Baring Vostok, РФПИ',
                                                        volume: 5.0,
                                                        active5000000: true
                                                    },
                                                    {
                                                        company: 'Travelata ',
                                                        subheader: 'Travel',
                                                        investor: 'РФПИ, Baring Vostok Capital Partners',
                                                        volume: 5.0,
                                                        active5000000: true
                                                    },
                                                    {
                                                        company: 'Cybertonica',
                                                        subheader: 'FinTech',
                                                        investor: 'Force Over Mass Capital, TrueSight Ventures, Springboard',
                                                        volume: 2.6,
                                                        active1137: true
                                                    },
                                                ],
                                            },
                                            mounted: function () {
                                                var self = this;
                                                $('.selectpicker-yeardeal').change(function () {
                                                    // отправляем данные на сервер
                                                    $.ajax({
                                                        // Метод отправки данных (тип запроса)
                                                        type: 'post',
                                                        // URL для отправки запроса
                                                        url: 'site/month',
                                                        // Данные формы
                                                        data: {
                                                            '_csrf': $('meta[name="csrf-token"]').attr('content'),
                                                            'AjaxTest': {
                                                                'exits': '0',
                                                                'year': $('#year').val(),
                                                                'quarter': $('#quarter').val(),
                                                                'yeardeal': $('#yeardeal').val(),
                                                                'monthdeal': $('#monthdeal').val()
                                                            }
                                                        }
                                                    }).done(function (data) {
                                                        if (data.error == null) {
                                                            // Если ответ сервера успешно получен
                                                            self.rows = data.data;
                                                        } else {
                                                            // Если при обработке данных на сервере произошла ошибка
                                                        }
                                                    })
                                                });
                                            }
                                        });
                                    </script>
                                </div>
                                <div class="left-invest">
                                    <div class="inv-graph-container">
                                        <div class="graph-wrapper">
                                            <div class="graph-wrapper_container">
                                                <div class="main-title">
                                                    Объем инвестиций, $ млн
                                                    <!-- <span>Январь - март 2020</span> -->
                                                </div>

                                                <div class="main-graph-body">
                                                    <div class="main-graph" data-graph-type="bar">

                                                        <div class="chart-wrapper">
                                                            <div class="chart-container">
                                                                <canvas id="main-graph" width="200" height="200"></canvas>
                                                            </div>
                                                        </div>

                                                        <div class="button-left button-left_static">
                                                            <select class="change selectpicker" title="" data-selected-text-format="static" data-dropdown-align-right="true">
                                                                <option>по месяцам</option>
                                                                <option>по кварталам</option>
                                                                <option>по годам</option>
                                                            </select>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="graph-wrapper_container">
                                                <div class="main-title">
                                                    Количество сделок
                                                </div>
                                                <div class="main-graph-body">
                                                    <div class="main-graph" data-graph-type="line">

                                                        <canvas id="exit-graph-line"></canvas>
                                                        <div class="button-left button-left_static">
                                                            <select class="change selectpicker" title="" data-selected-text-format="static" data-dropdown-align-right="true">
                                                                <option>по месяцам</option>
                                                                <option>по кварталам</option>
                                                                <option>по годам</option>
                                                            </select>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <script>
                                        $(function () {
                                    
                                            let responseData = {};
                                            var lineCanvas = $("#exit-graph-line");
                                    
                                            var ctx = lineCanvas[0].getContext('2d');
                                    
                                            var amountOfVolume = {
                                                labels: [],
                                                datasets: [
                                                    {
                                                        data: [],
                                                        borderWidth: 4,
                                                        borderColor: '#F20EB5',
                                                        cubicInterpolationMode: 'monotone',
                                                        pointBackgroundColor: 'rgba(255, 255, 255, 0)',
                                                        pointBorderWidth: 1,
                                                        type: 'line',
                                                        pointBorderColor: 'rgba(255, 255, 255, 0)',
                                                        fill: false
                                                    },
                                                    {
                                                        data: [],
                                                        labels: [],
                                                        maxBarThickness: 2,
                                                        backgroundColor: ['rgba(0,0,0,0.1)', 'rgba(0,0,0,0.1)', 'rgba(0,0,0,0.1)', 'rgba(0,0,0,0.1)', 'rgba(0,0,0,0.1)'],
                                                        datalabels: {
                                                            display: false
                                                        }
                                                    }]
                                            }
                                    
                                            var linechartOptions = {
                                                maintainAspectRatio: false,
                                                plugins: {
                                                    legend: {
                                                        display: false
                                                    },
                                                    tooltips: {
                                                        enabled: true,
                                                    },
                                                    tooltip: {
                                                        position: 'nearest',
                                                        enabled: true,
                                                        intersect: false,
                                                        padding: {
                                                            top: 5,
                                                            left: 10,
                                                            bottom: 5,
                                                            right: 10
                                                        },
                                                        caretSize: 4,
                                                        backgroundColor: '#0458FE',
                                                        titleFont: {
                                                            family: 'Roboto',
                                                            size: 10,
                                                            weight: '500',
                                                        },
                                                        titleColor: '#ffffff',
                                                        bodyColor: '#ffffff',
                                                        borderColor: '#0458FE',
                                                        borderWidth: 4,
                                                        callbacks: {
                                                            title: function (tooltipItems) {
                                                                return (Array.isArray(tooltipItems[0].label)
                                                                        ? tooltipItems[0].label.join('. ').replace('КВ', 'кв')
                                                                        : tooltipItems[0].label
                                                                    )
                                                                    + '\n$ ' + tooltipItems[0].formattedValue + ' млн';
                                                            },
                                                            label: function () {
                                                                return false;
                                                            },
                                                        }
                                                    },
                                                    datalabels: {
                                                        color: '#000',
                                                        font: {
                                                            size: 10,
                                                            family: 'Roboto',
                                                            lineHeight: 2.5,
                                                            weight: 500
                                                        },
                                                        padding: {
                                                            top: 0,
                                                            bottom: 0
                                                        },
                                                        backgroundColor: 'rgba(255,255,255,0)',
                                                        anchor: 'end',
                                                        align: 'end'
                                                    }
                                                },
                                                responsive: true,
                                                layout: {
                                                    padding: {
                                                        left: 0,
                                                        right: 0,
                                                        top: 20,
                                                        bottom: 0
                                                    }
                                                },
                                                scales: {
                                                    x: {
                                                        barPercentage: 0.09,
                                                        gridLines: {
                                                            display: true,
                                                            zeroLineWidth: 1,
                                                            drawBorder: false
                                                        },
                                                        grid: {
                                                            drawBorder: false,
                                                            display: false
                                                        },
                                                        ticks: {
                                                            fontColor: '#000',
                                                            autoSkip: false,
                                                            maxRotation: 0,
                                                            minRotation: 0,
                                                            font: {
                                                                size: 10,
                                                                family: 'IBM Plex Sans',
                                                            }
                                                        }
                                    
                                                    },
                                    
                                                    y: {
                                                        gridLines: {
                                                            tickMarkLength: 0,
                                                            drawBorder: true,
                                                            display: false
                                                        },
                                                        display: false,
                                                        grid: {
                                                            drawBorder: false,
                                                            display: false
                                                        },
                                                        ticks: {
                                                            min: 0,
                                                            max: 180,
                                                            display: false,
                                                        }
                                                    }
                                                }
                                            }
                                    
                                            var lineChart = new Chart(ctx, {
                                    
                                                type: 'bar',
                                                data: amountOfVolume,
                                                options: linechartOptions,
                                                plugins: [ChartDataLabels, {
                                                    beforeInit: function (Chart) {
                                                        Chart.data.labels.forEach(function (e, i, a) {
                                                            if (/\n/.test(e)) {
                                                                a[i] = e.split(/\n/);
                                                            }
                                                        });
                                                    }
                                                }]
                                    
                                            })
                                            $.fn.mainGraphLineRefresh = function (groupBy) {
                                    
                                                /* это только для демонстрации статично, в готовом варианте убрать, будет подгружаться ajax */
                                                let data = {};
                                                if (groupBy == 'по месяцам') {
                                                    data = {
                                                        "labels": ["янв", "фев", "мар", "апр", "май", "июн", "июл", "авг", "сен", "окт", "ноя", "дек"],
                                                        "amounts": [130, 160, 60, 90, 120, 30, 100, 150, 60, 100, 130, 50],
                                                    };
                                                } else {
                                                    data = {
                                                        "labels": ["2017", "2018", "2019", "2020", "2021\nянв-июн"],
                                                        "amounts": [130, 160, 60, 90, 120],
                                                    };
                                                }
                                                responseData = data;
                                                lineChart.data.labels = data.labels;
                                                lineChart.data.datasets[0].data = data.amounts;
                                                lineChart.data.datasets[1].data = data.amounts;
                                                lineChart.update();
                                                /* конец части котрую нужно удалить*/
                                    
                                                if (groupBy == 'по месяцам') {
                                                    lineChart.canvas.parentNode.style.width = '400px';
                                                } else {
                                                    lineChart.canvas.parentNode.style.width = '100%';
                                                }
                                    
                                                lineChart.canvas.parentNode.style.height = '150px';
                                    
                                    
                                                $.ajax({
                                                    type: 'post',
                                                    url: '/startup/investment-volumes-by-time-periods/',
                                                    data: {
                                                        'sort': groupBy,
                                                    }
                                                }).done(function (data) {
                                                    responseData = data
                                                    if (data.error == null) {
                                                        responseData = data;
                                                        lineChart.data.labels = data.labels;
                                                        lineChart.data.datasets[0].data = data.amounts;
                                                        lineChart.data.datasets[1].data = data.amounts;
                                                        lineChart.update();
                                                    } else {
                                                        console.log(data.error);
                                                    }
                                                })
                                            }
                                    
                                            $('.main-graph[data-graph-type="line"]').mainGraphLineRefresh('по месяцам')
                                            $('.main-graph[data-graph-type="line"]').find('.selectpicker').on('change', function () {
                                    
                                                $(this).closest('.main-graph[data-graph-type="bar"]').mainGraphLineRefresh($(this).val());
                                            });
                                        })
                                    </script>

                                    <script>
                                        var data = {
                                            // A labels array that can contain any sort of values
                                            labels: ["2017", "2018", "2019", "2020\nянв-окт"],
                                            // Our series array that contains series objects or in this case series data arrays
                                            series: [
                                                [195, 183, 122, 103]
                                            ]
                                        };
                                        var options = {
                                            high: 197,
                                            low: 0,
                                            fullWidth: true,
                                            chartPadding: {
                                                right: 30,
                                                left: 0
                                            },
                                            axisY: {
                                                showGrid: false,
                                                showLabel: false,
                                                onlyInteger: true
                                            },
                                            plugins: [
                                                Chartist.plugins.ctPointLabels({
                                                    textAnchor: 'middle'
                                                })
                                            ]
                                        }
                                    
                                        // Create a new line chart object where as first parameter we pass in a selector
                                        // that is resolving to our chart container element. The Second parameter
                                        // is the actual data object.
                                        new Chartist.Line('.ct-chart', data, options);
                                    </script>


                                    <script>
                                        $(function () {
                                    
                                    
                                            let responseData = {};
                                    
                                            var amountOfVolume = {
                                                labels: [],
                                                datasets: [{
                                                    data: [],
                                                    backgroundColor: ['#0458FE', '#0458FE', '#0458FE', '#F20EB5'],
                                                    maxBarThickness: 4,
                                                    borderRadius: 10,
                                                    borderSkipped: false,
                                                }]
                                    
                                            };
                                    
                                            var chartOptions = {
                                                responsive: true,
                                                maintainAspectRatio: false,
                                                layout: {
                                                    padding: {
                                                        left: 0,
                                                        right: 0,
                                                        top: 20,
                                                        bottom: 0
                                                    }
                                                },
                                                plugins: {
                                                    tooltips: {
                                                        enabled: true,
                                                    },
                                                    tooltip: {
                                                        position: 'nearest',
                                                        enabled: true,
                                                        intersect: false,
                                                        padding: {
                                                            top: 5,
                                                            left: 10,
                                                            bottom: 5,
                                                            right: 10
                                                        },
                                                        caretSize: 4,
                                                        backgroundColor: '#0458FE',
                                                        titleFont: {
                                                            family: 'Roboto',
                                                            size: 10,
                                                            weight: '500',
                                                        },
                                                        titleColor: '#ffffff',
                                                        bodyColor: '#ffffff',
                                                        borderColor: '#0458FE',
                                                        borderWidth: 4,
                                                        callbacks: {
                                                            title: function (tooltipItems) {
                                                                return (Array.isArray(tooltipItems[0].label)
                                                                        ? tooltipItems[0].label.join('. ').replace('КВ', 'кв')
                                                                        : tooltipItems[0].label
                                                                    )
                                                                    + '\n$ ' + tooltipItems[0].formattedValue + ' млн';
                                                            },
                                                            label: function () {
                                                                return false;
                                                            },
                                                        }
                                                    },
                                                    legend: {
                                                        display: false
                                                    },
                                                    datalabels: {
                                                        color: '#000',
                                                        font: {
                                                            size: 10,
                                                            family: 'IBM Plex Sans',
                                                            lineHeight: 1,
                                                            weight: 500
                                                        },
                                                        padding: {
                                                            top: 0,
                                                            bottom: 0
                                                        },
                                                        anchor: 'end',
                                                        align: 'end'
                                                    }
                                                },
                                    
                                                scales: {
                                                    x: {
                                                        barPercentage: 0.2,
                                                        gridLines: {
                                                            display: false,
                                                            zeroLineWidth: 0,
                                                            tickMarkLength: 0,
                                                            zeroLineColor: 'white',
                                                            color: 'transparent',
                                                            drawBorder: false
                                                        },
                                                        grid: {
                                                            drawBorder: false,
                                                            display: false
                                                        },
                                                        ticks: {
                                                            fontColor: '#000',
                                                            fontSize: 10,
                                                            autoSkip: false,
                                                            maxRotation: 0,
                                                            minRotation: 0,
                                    
                                                            font: {
                                                                size: 10,
                                                                family: 'IBM Plex Sans',
                                                            }
                                                        }
                                                    },
                                    
                                                    y: {
                                                        grid: {
                                                            drawBorder: false,
                                                            display: false
                                                        },
                                                        gridLines: {
                                                            tickMarkLength: 0,
                                                            drawBorder: false,
                                                            zeroLineWidth: 0,
                                                            zeroLineColor: 'white',
                                                            color: 'transparent',
                                                            display: false
                                                        },
                                                        display: false,
                                                        ticks: {
                                                            display: false
                                                        }
                                                    }
                                                },
                                                onHover: function (mouseEvent, chartElements, chart) {
                                                    if (chartElements.length) {
                                                        mouseEvent.native.target.style.cursor = 'pointer';
                                                    } else {
                                                        mouseEvent.native.target.style.cursor = 'default';
                                                    }
                                                },
                                                onClick: function (mouseEvent, chartElements) {
                                                    console.log('onClick')
                                                    console.log(chartElements)
                                                    if (chartElements.length) {
                                                        const index = chartElements[0].datasetIndex;
                                                        let period = responseData.periods[index].year
                                                            + '-'
                                                            + responseData.periods[index].startMonth
                                                            + '|'
                                                            + responseData.periods[index].year
                                                            + '-'
                                                            + responseData.periods[index].finishMonth;
                                                        let urlParams = new URLSearchParams();
                                                        urlParams.set('period', period);
                                                        location.href = '/startups/?' + urlParams.toString();
                                                    }
                                                },
                                            }
                                            var ctx = document.getElementById("main-graph").getContext("2d");
                                            Chart.defaults.family = "IBM Plex Sans";
                                            Chart.defaults.size = "10";
                                            Chart.defaults.color = "#000000";
                                            Chart.defaults.style = 'normal';
                                            var barChart = new Chart(ctx, {
                                                type: 'bar',
                                                data: amountOfVolume,
                                                options: chartOptions,
                                                plugins: [ChartDataLabels, {
                                                    beforeInit: function (Chart) {
                                                        Chart.data.labels.forEach(function (e, i, a) {
                                                            if (/\n/.test(e)) {
                                                                a[i] = e.split(/\n/);
                                                            }
                                                        });
                                                    }
                                                }]
                                    
                                            })
                                            $.fn.mainGraphBarRefresh = function (groupBy) {
                                    
                                                /* это только для демонстрации статично, в готовом варианте убрать, будет подгружаться ajax */
                                                let data = {};
                                                if (groupBy == 'по месяцам') {
                                                    data = {
                                                        "labels": [["III КВ", "2019"], ["IV КВ", "2019"], ["I КВ", "2020"], ["II КВ", "2020"], ["III КВ", "2020"], ["IV КВ", "2020"], ["I КВ", "2021"], ["II КВ", "2021"]],
                                                        "amounts": ["260.3", "84.2", "191.3", "100.3", "73.2", "171.1", "120.6", "60.2"],
                                                    };
                                                } else {
                                                    data = {
                                                        "labels": [["II КВ", "2020"], ["III КВ", "2020"], ["IV КВ", "2020"], ["I КВ", "2021"], ["II КВ", "2021"]],
                                                        "amounts": ["260.3", "84.2", "191.3", "100.3", "73.2"],
                                                    };
                                                }
                                                responseData = data;
                                                barChart.data.labels = data.labels;
                                                barChart.data.datasets[0].data = data.amounts;
                                                barChart.update();
                                                /* конец части котрую нужно удалить*/
                                    
                                                if (groupBy == 'по месяцам') {
                                                    barChart.canvas.parentNode.style.width = '350px';
                                                } else {
                                                    barChart.canvas.parentNode.style.width = '100%';
                                                }
                                    
                                                barChart.canvas.parentNode.style.height = '150px';
                                    
                                                $.ajax({
                                                    type: 'post',
                                                    url: '/startup/investment-volumes-by-time-periods/',
                                                    data: {
                                                        'sort': groupBy,
                                                    }
                                                }).done(function (data) {
                                                    responseData = data
                                                    if (data.error == null) {
                                                        responseData = data;
                                                        barChart.data.labels = data.labels;
                                                        barChart.data.datasets[0].data = data.amounts;
                                                        barChart.update();
                                                    } else {
                                                        console.log(data.error);
                                                    }
                                                })
                                            }
                                    
                                            $('.main-graph[data-graph-type="bar"]').mainGraphBarRefresh('по месяцам')
                                            $('.main-graph[data-graph-type="bar"]').find('.selectpicker').on('change', function () {
                                    
                                                $(this).closest('.main-graph[data-graph-type="bar"]').mainGraphBarRefresh($(this).val());
                                            });
                                        });
                                    </script>
                                    <div class="table-container">
                                        <div class="table-wrapper">
                                            <div class="main-title">Направления инвестиций</div>
                                            <div class="buttons-row">
                                                <div class="left-buttons">
                                                    <a class="lb active" href="#">Рыночные ниши</a>
                                                    <a class="lb" href="#">Технологии</a>
                                                </div>
                                                <div class="right-buttons">
                                                    <a class="rb" href="#"><span class="mr-2">Изменить представление</span><span><i class="fas fa-chevron-down" aria-hidden="true"></i></span></a>
                                                </div>
                                            </div>
                                            <div class="main-table">
                                                <table id="vueTable">
                                                    <thead>
                                                        <tr>
                                                            <th class="main-h">Объем инвестиций</th>
                                                            <th class="year-h">2017</th>
                                                            <th class="year-h">2018</th>
                                                            <th class="year-h">2019</th>
                                                            <th class="year-h">2020</th>
                                                            <th class="year-h">2021
                                                                <br> <span>янв - мар</span>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr v-for="row in rows">
                                                            <td class="td-company">
                                                                <a :href="row.link" v-html="row.company"></a>
                                                            </td>
                                                            <td class="td-volume" v-text="row.r2017" :style="styleVal(row.r2017)"></td>
                                                            <td class="td-volume" v-text="row.r2018" :style="styleVal(row.r2018)"></td>
                                                            <td class="td-volume" v-text="row.r2019" :style="styleVal(row.r2019)"></td>
                                                            <td class="td-volume" v-text="row.r2020" :style="styleVal(row.r2020)"></td>
                                                            <td class="td-volume" v-text="row.r2020" :style="styleVal(row.r2021)"></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class="button-block">
                                                <a href="#" class="main-btn">Все направления</a>
                                            </div>
                                        </div>
                                    </div>

                                    <script>
                                        var companiesTable = new Vue({
                                            el: '#vueTable',
                                            data: {
                                                rows: [
                                    							{ company: 'Advertising & Marketing', link: '/?r=site%2Finside&map=spheres&name=Advertising+%26+Marketing&exits=0', r2017: '$ 2.8', r2018: '$ 10.1', r2019: '$ 5.5', r2020: '$ 3.0' , r2021: '$ 12.2' },
                                    							{ company: 'AgroTech', link: '/?r=site%2Finside&map=spheres&name=AgroTech&exits=0', r2017: '$ 0.2', r2018: '$ 0.5', r2019: '$ 1.0', r2020: '$ 9.0' , r2021: '$ 12.2' },
                                    							{ company: 'Business Software', link: '/?r=site%2Finside&map=spheres&name=Business+Software&exits=0', r2017: '$ 4.0', r2018: '$ 43.8', r2019: '$ 13.6', r2020: '$ 3.9' , r2021: '$ 12.2' },
                                    							{ company: 'CleanTech', link: '/?r=site%2Finside&map=spheres&name=CleanTech&exits=0', r2017: '$ 0.9', r2018: '$ 1.5', r2019: '$ 3.2', r2020: '$ 0.0' , r2021: '$ 12.2' },
                                    							{ company: 'Consumer Goods & Services', link: '/?r=site%2Finside&map=spheres&name=Consumer+Goods+%26+Services&exits=0', r2017: '$ 11.4', r2018: '$ 3.4', r2019: '$ 1.2', r2020: '$ 0.5' , r2021: '$ 12.2' },
                                    							{ company: 'Cybersecurity', link: '/?r=site%2Finside&map=spheres&name=Cybersecurity&exits=0', r2017: '$ 23.2', r2018: '$ 8.1', r2019: '$ 147.0', r2020: '$ 0.0' , r2021: '$ 12.2' },
                                    							{ company: 'E-commerce', link: '/?r=site%2Finside&map=spheres&name=E-commerce&exits=0', r2017: '$ 2.0', r2018: '$ 179.7', r2019: '$ 174.1', r2020: '$ 155.8' , r2021: '$ 12.2' },
                                    							{ company: 'EdTech', link: '/?r=site%2Finside&map=spheres&name=EdTech&exits=0', r2017: '$ 4.0', r2018: '$ 13.2', r2019: '$ 9.6', r2020: '$ 11.7' , r2021: '$ 12.2' },
                                    							{ company: 'Entertainment', link: '/?r=site%2Finside&map=spheres&name=Entertainment&exits=0', r2017: '$ 6.9', r2018: '$ 18.3', r2019: '$ 56.4', r2020: '$ 54.6'  , r2021: '$ 12.2'},
                                    							{ company: 'FashionTech', link: '/?r=site%2Finside&map=spheres&name=FashionTech&exits=0', r2017: '$ 0.4', r2018: '$ 0.8', r2019: '$ 1.1', r2020: '$ 1.5' , r2021: '$ 12.2' },
                                    							{ company: 'FinTech', link: '/?r=site%2Finside&map=spheres&name=FinTech&exits=0', r2017: '$ 54.3', r2018: '$ 20.0', r2019: '$ 2.0', r2020: '$ 7.7'  , r2021: '$ 12.2'},
                                    							{ company: 'FoodTech', link: '/?r=site%2Finside&map=spheres&name=FoodTech&exits=0', r2017: '$ 11.4', r2018: '$ 2.7', r2019: '$ 16.0', r2020: '$ 12.2' , r2021: '$ 12.2' },
                                                    /* { company: "Fintech", r2017: 135, r2018: 135, r2019: 135, r2020: 135 },
                                                    { company: "E-commerce", r2017: 170, r2018: 170, r2019: 170, r2020: 170},
                                                    { company: "Healthcare", r2017: 95, r2018: 95, r2019: 95, r2020: 95},
                                                    { company: "Foodtech", r2017: 14, r2018: 14, r2019: 14, r2020: 14},
                                                    { company: "Agrotech", r2017: 10, r2018: 10, r2019: 10, r2020: 10},
                                                    { company: "Cybersecurity", r2017: 5, r2018: 5, r2019: 5, r2020: 5},
                                                    { company: "Edtech", r2017: 46, r2018: 46, r2019: 46, r2020: 46},
                                                    { company: "Transport", r2017: 26, r2018: 26, r2019: 26, r2020: 26},
                                                    { company: "Spacetech", r2017: 21, r2018: 21, r2019: 21, r2020: 21,},
                                                    { company: "Cleantech", r2017: 14, r2018: 14, r2019: 14, r2020: 14},
                                                    { company: "Proptech", r2017: 40, r2018: 40, r2019: 40, r2020: 40,},
                                                    { company: "Telecom", r2017: 2, r2018: 2, r2019: 2, r2020: 2}, */
                                                    /* { company: "Industrial Tech", r2017: '95', r2018: '95', r2019: '95', r2020: '95'},
                                                    { company: "Entertainment", r2017: '14', r2018: '14', r2019: '14', r2020: '14'},
                                                    { company: "Gaming", r2017: '10', r2018: '10', r2019: '10', r2020: '10'},
                                                    { company: "Sporttech", r2017: '5', r2018: '5', r2019: '5', r2020: '5'},
                                                    { company: "Travel", r2017: '10', r2018: '46', r2019: '46', r2020: '46'},
                                                    { company: "InsuranceTech", r2017: '5', r2018: '26', r2019: '26', r2020: '26'},
                                                    { company: "LegalTech", r2017: '46', r2018: '21', r2019: '21', r2020: '21'},
                                                    { company: "Advertising & Marketing", r2017: '26', r2018: '14', r2019: '14', r2020: '14'},
                                                    { company: "Мedia & Communication", r2017: '21', r2018: '10', r2019: '40', r2020: '40'},
                                                    { company: "Fashiontech", r2017: '46', r2018: '5', r2019: '95', r2020: '10'},
                                                    { company: "HRTech", r2017: '26', r2018: '46', r2019: '14', r2020: '5'},
                                                    { company: "Business Software", r2017: '21', r2018: '26', r2019: '10', r2020: '46'},
                                                    { company: "Consumer Goods & Services", r2017: '14', r2018: '21', r2019: '5', r2020: '1'} */
                                                ]
                                            },
                                    				computed: {
                                    					tableMax() {
                                    						return this.rows.reduce((max, current, array) => {
                                    							max = Math.max(Math.max(
                                    								current.r2017.match('[0-9]+\.[0-9]+|[0-9]+'),
                                    								current.r2018.match('[0-9]+\.[0-9]+|[0-9]+'),
                                    								current.r2019.match('[0-9]+\.[0-9]+|[0-9]+'),
                                    								current.r2020.match('[0-9]+\.[0-9]+|[0-9]+')
                                    							), max)
                                    							return max
                                    						}, 0)
                                    					}
                                    				},
                                    				methods: {
                                    					styleVal (val) {
                                    						if (!isNaN(this.tableMax)) {
                                    							// let bgOpacity = Math.round(10 + val.match('[0-9]+\.[0-9]+|[0-9]+') * 95 / this.tableMax) / 100;
                                    							let frac = Math.round(val.match('[0-9]+\.[0-9]+|[0-9]+') * 100 / this.tableMax) / 100
                                    							let bgOpacity = 1
                                    
                                    							if (frac < .05) bgOpacity = .04
                                    							else if (.05 <= frac < .11) bgOpacity = .1
                                    							else if (.11 <= frac < .21) bgOpacity = .2
                                    							else if (.21 <= frac < .41) bgOpacity = .4
                                    							else if (.41 <= frac < .61) bgOpacity = .6
                                    							else bgOpacity = 1
                                    
                                    							let color = bgOpacity < .3 ? '#6D798F' : '#fff'
                                    
                                    							return 'backgroundColor: rgba(4,89,255,'+ bgOpacity +'); color: '+ color;
                                    						}
                                    						else {
                                    							return ''
                                    						}
                                    					},
                                    				}
                                        });
                                    </script>
                                </div>
                            </div>
                        </div>
                        <div class="invest-container mt-4">
                            <div class="left-invest">

                                <!--<div class="inv-graph-container">


    <div class="graph-wrapper">
        <div class="finance-graph">
            <button class="click-list">
                <i class="fas fa-chevron-down"></i>
            </button>
            <button class="click-list close">
                <img src="static/img/content/deals/close-button.svg" alt="">
            </button>

            <div class="years-list first">
                <div class="period">
                    <div class="list-title">Год</div>
                    <div class="list-year">
                        <select class="y selectpicker selectpicker-year" id="finance-year">
                            <option value="2020" selected>2020</option>
                            <option value="2019">2019</option>
                            <option value="2018">2018</option>
                            <option value="2017">2017</option>
                        </select>
                    </div>
                </div>
                <div class="period">
                    <div class="list-title">Период</div>
                    <div class="list-year">
                        <select class="y selectpicker selectpicker-year" id="finance-quarter">
                            <option value="1">&#8544; квартал</option>
                            <option value="2">&#8545; квартал</option>
                            <option value="3">&#8546; квартал</option>
                            <option value="4" selected>&#8547; квартал</option>
                            <option value="0" selected>год</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="main-title">
                Распределение инвестиций по&nbsp;раундам финансирования
            </div>
            <div class="finance-grid row mt-4">
                <div class="col-lg-6 text-center mb-5 mb-lg-0">
                    <div class="finance-grid__title">РАспределение инвестиций по раундам финансирования</div>
                    <canvas id="if-chart" height="250"></canvas>
                </div>
                <div class="col-lg-6 text-center">
                    <div class="finance-grid__title">количество сделок</div>
                    <canvas id="сd-chart" height="250"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>


<script>

    function determineBorderRadius(context) {
        const numDatasets = context.chart.data.datasets.length;
        let showBorder = false;
        console.log('hi')
        if (context.datasetIndex === numDatasets - 1) {
            // Last dataset, always a yes
            showBorder = true;
        } else if (context.parsed.y !== 0) {
            // We show a radius when we're the highest value in a positive stack
            // or the lowest value in a negative stack
            const sign = Math.sign(context.parsed.y);
            let matches = false;

            // Look for any other non-0 values in the same stack that have the same sign
            for (let i = context.datasetIndex + 1; i < numDatasets; i++) {
                const val = context.parsed._stacks.y[i];
                if (val && Math.sign(val) == sign) {
                    matches = true;
                    break;
                }
            }

            showBorder = !matches;
        }

        if (!showBorder) {
            return 0;
        }

        let radius = 0;
        if (context.parsed.y > 0) {
            return {
                topLeft: 10,
                topRight: 10,
            };
        } else if (context.parsed.y < 0) {
            return {
                bottomLeft: 10,
                bottomRight: 10,
            };
        }
        return radius;
    };

    var investmentChartData = {
        labels: ['2017', '2018', '2019', '2020', 'янв-май 2021',],

        datasets: [

            {
                label: 'Раунд C',
                backgroundColor: '#6A9DFF',
                data: [17, 40, 62, 68, 58],
                labels: [],
                borderWidth: 0,
            }, {
                label: 'Раунд B',
                backgroundColor: '#F20EB5',
                data: [35, 35, 18, 10, 18],
                labels: [],
                borderWidth: 0,

            }, {
                label: 'Раунд A',
                backgroundColor: '#F8C52F',
                data: [32, 16, 16, 17, 23],
                labels: [],
                borderWidth: 0,
            },
            {
                label: 'Seed',
                backgroundColor: '#39B18B',
                data: [14, 8, 4, 4, 1],
                labels: [],
                borderWidth: 0,
            },
            {
                label: 'Pre-seed',
                backgroundColor: '#0458FE',
                data: [2, null, null, null, null],
                labels: [],
                borderWidth: 0,
            },

        ]

    };
    const investmentChartDataClone = JSON.parse(JSON.stringify(investmentChartData))


    var dealChartData = {
        labels: ['2017', '2018', '2019', '2020', 'янв-май 2021',],
        datasets: [
            {
                label: 'Раунд B',
                backgroundColor: '#F20EB5',
                data: [7, 9, 14, 7, 21],
                labels: [],
                borderWidth: 0,
            },
            {
                label: 'Раунд C',
                backgroundColor: '#6A9DFF',
                data: [3, 2, 5, 8, 7],
                labels: [],
                borderWidth: 0,

            },
            {
                label: 'Раунд A',
                backgroundColor: '#F8C52F',
                data: [19, 19, 26, 28, 30],
                labels: [],
                borderWidth: 0,
            },
            {
                label: 'Seed',
                backgroundColor: '#39B18B',
                data: [41, 39, 41, 39, 33],
                labels: [],
                borderWidth: 0,
            },
            {
                label: 'Pre-seed',
                backgroundColor: '#0458FE',
                data: [30, 31, 14, 18, 9],
                labels: [],
                borderWidth: 0,
            },

        ]

    };
    const dealChartDataClone = JSON.parse(JSON.stringify(dealChartData))


    var ifChartoptions = {

        // skipNull: false,
        // maintainAspectRatio: false,
        elements: {
            bar: {
                borderRadius: 10
            },
        },
        title: {
            display: false,
            text: ''
        },

        plugins: {
            tooltip: {
                enabled: false
            },
            datalabels: {
                color: '#ffffff',
                font: {
                    family: 'Roboto',
                    size: '10',
                    weight: '500',
                },
                formatter: function (value, context) {
                    return context.dataset.labels[context.dataIndex] != null ? context.dataset.labels[context.dataIndex] + '%' : '';
                }
            },
            legend: {
                position: "bottom",
                pointStyle: 'circle',
                labels: {
                    pointStyle: 'circle',
                    usePointStyle: true,
                    boxWidth: 6,
                    boxHeight: 6,
                    color: 'rgba(119, 124, 152, .75)',
                    padding: 20,
                    font: {
                        size: 12,
                        family: 'IBM Plex Sans',

                    }
                }
            },

        },

        interaction: {
            intersect: false,
        },
        responsive: true,
        scales: {
            x: {
                stacked: true,
                gridLineWidth: 0,
                scaleLineColor: 'transparent',

                gridLines: {
                    drawBorder: false,
                    display: false,
                    color: "rgba(0, 0, 0, 0)",
                },
                grid: {
                    display: false
                },
                ticks: {
                    autoSkip: $(window).width() > 450 ? false : true,
                    maxRotation: $(window).width() > 450 ? 0 : 25,
                    minRotation: 0,
                    color: '#3A414E',
                    font: {
                        size: 10,
                        family: 'Roboto',
                        weight: '500'
                    }
                },

            },
            y: {
                stacked: true,
                display: false,
                grid: {
                    display: false
                },
                ticks: {
                    color: '#ff0000',
                    display: false,
                }

            },
        },
    };

    window.onload = function () {

        function copyDataToLabels() {
            for (i = 0; i < dealChartData.datasets.length; i++) {
                dealChartData.datasets[i].labels = dealChartDataClone.datasets[i].data
                console.log(dealChartData.datasets[i].labels)
            }
            for (i = 0; i < investmentChartData.datasets.length; i++) {
                investmentChartData.datasets[i].labels = investmentChartDataClone.datasets[i].data
            }

        }


        Chart.defaults.family = "Roboto";
        Chart.defaults.size = "10";
        Chart.defaults.style = '500';
        Chart.defaults.lineHeight = "1";

        if ($(window).width() > 650) {
            Chart.defaults.datasets.bar.categoryPercentage = 0.9;
            Chart.defaults.datasets.bar.barPercentage = 0.7;
        } else {
            Chart.defaults.datasets.bar.categoryPercentage = 1;
            Chart.defaults.datasets.bar.barPercentage = 0.9;
        }


        function showMoreHeightMethod(chart) {
            chart.datasets.forEach(item => {
                for (let i = 0; i <= item.data.length; i++) {
                    if ((item.data[i] <= 6) & (item.data[i] !== null)) {
                        let barIndex = item.data.indexOf(item.data[i])
                        let delta = (11 - item.data[i])
                        console.log(delta)
                        let newArr = []
                        chart.datasets.forEach(item => {
                            newArr.push(item.data[barIndex])
                        })
                        let maxEl = Math.max.apply(null, newArr)
                        chart.datasets.forEach(item => {
                            if (item.data[barIndex] === maxEl) {
                                item.data[barIndex] = item.data[barIndex] - delta
                            }
                        })
                        item.data[i] = 11
                    }

                    if ((item.data[i] > 6) & (item.data[i] <= 10) & (item.data[i] !== null)) {
                        let barIndex = item.data.indexOf(item.data[i])
                        let delta = (13 - item.data[i])
                        let newArr = []
                        chart.datasets.forEach(item => {
                            newArr.push(item.data[barIndex])
                        })
                        let maxEl = Math.max.apply(null, newArr)
                        chart.datasets.forEach(item => {
                            if (item.data[barIndex] === maxEl) {
                                item.data[barIndex] = item.data[barIndex] - delta
                            }
                        })
                        item.data[i] = 13
                    }
                }

            })
        }


        showMoreHeightMethod(dealChartData);
        showMoreHeightMethod(investmentChartData);
        copyDataToLabels();


        var ctx = document.getElementById('if-chart').getContext('2d');
        ctx.height = 250;
        $('#if-chart').width($('#if-chart').parent('div').width());
        investmentBar = new Chart(ctx, {
            type: 'bar',
            plugins: [ChartDataLabels],
            data: investmentChartData,
            options: ifChartoptions,
            maintainAspectRatio: false,
        });

        //investmentBar.canvas.parentNode.style.height = '300px';
        //document.getElementById('if-chart-legend').innerHTML = investmentBar.generateLegend();
        var ctdx = document.getElementById('сd-chart').getContext('2d');
        $('#сd-chart').width($('#сd-chart').parent('div').width());

        ctdx.height = 250;
        myCdBar = new Chart(ctdx, {
            type: 'bar',
            plugins: [ChartDataLabels],
            data: dealChartData,
            options: ifChartoptions,
            maintainAspectRatio: false,
        });

        // myCdBar.canvas.parentNode.style.height = '300px';
        //  document.getElementById('сd-chart-legend').innerHTML = myCdBar.generateLegend();
        $(window).resize(function () {
            $('#if-chart').width($('#if-chart').parent('div').width());
            $('#сd-chart').width($('#сd-chart').parent('div').width());
            myCdBar.update();
            investmentBar.update();
        });

    };

</script>
-->
                                <div class="inv-graph-container">

                                    <div class="graph-wrapper">
                                        <div class="finance-graph">
                                            <div class="finance-graph__title">
                                                <div class="main-title">
                                                    Распределение инвестиций по&nbsp;раундам финансирования
                                                </div>
                                            </div>
                                            <div class="finance-grid row mt-4">
                                                <div class="col-lg-6 text-center mb-5 mb-lg-0">
                                                    <div class="finance-grid__header">
                                                        <div class="finance-grid__title">
                                                            ОБЪЕМ ИНВЕСТИЦИЙ
                                                        </div>
                                                        <div class="button-left button-left_static">
                                                            <select id="invest-select" class="change selectpicker" title="" data-selected-text-format="static" data-dropdown-align-right="true">
                                                                <option>по месяцам</option>
                                                                <option>по кварталам</option>
                                                                <option>по годам</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="finance-grath">
                                                        <div class="finance-grath__container">
                                                            <!-- при изменении периода показа надо менять ширину на подходящуюю -->
                                                            <canvas id="invest-chart" height="180"></canvas>
                                                        </div>
                                                        <div id="invest-legend" class="finance-legend"></div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-6 text-center">
                                                    <div class="finance-grid__header">
                                                        <div class="finance-grid__title">
                                                            количество сделок
                                                        </div>
                                                        <div class="button-left button-left_static">
                                                            <select id="deal-select" class="change selectpicker" title="" data-selected-text-format="static" data-dropdown-align-right="true">
                                                                <option>по месяцам</option>
                                                                <option>по кварталам</option>
                                                                <option>по годам</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="finance-grath">
                                                        <div class="finance-grath__container">
                                                            <canvas id="deal-chart" height="180"></canvas>
                                                        </div>
                                                        <div id="finance-legend" class="finance-legend"></div>
                                                    </div>
                                                </div>
                                                <div class="col-12">

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <script>
                                    let investData = {
                                        labels: [2017, 2018, 2019, 2020, 2021, 2022],
                                        datasets: [
                                            {
                                                label: '',
                                                data: [0, 0, 0, 0, 0, 0],
                                                borderColor: '#80C2FF',
                                                backgroundColor: '#80C2FF',
                                                active: false,
                                            },
                                            {
                                                label: 'Pre-seed',
                                                borderColor: '#B7C2D7',
                                                backgroundColor: '#B7C2D7',
                                                data: [9, 7, 4, 5, 4, 1],
                                                fill: '-1'
                                
                                            },
                                            {
                                                label: 'Seed',
                                                borderColor: '#F20EB5',
                                                backgroundColor: '#F20EB5',
                                                data: [12, 43, 66, 67, 50, 74],
                                                fill: '-1',
                                                borderWidth: 0,
                                            },
                                            {
                                                label: 'Раунд A',
                                                borderColor: '#570EF2',
                                                backgroundColor: '#570EF2',
                                                data: [53, 16, 13, 17, 23, 14],
                                                fill: '-1',
                                                borderWidth: 0,
                                            },
                                            {
                                                label: 'Раунд B',
                                                borderColor: '#80C2FF',
                                                backgroundColor: '#80C2FF',
                                                data: [] /*[1, 1, 0, 1, 0, 4]*/,
                                                fill: '-1'
                                            },
                                            {
                                                label: 'Раунд C+',
                                                borderColor: '#4D7EFC',
                                                backgroundColor: '#4D7EFC',
                                                data: [25, 33, 17, 10, 23, 7],
                                                fill: '-1'
                                            }
                                        ]
                                    };
                                    
                                        
                                    for (let i = 0; i < investData.datasets.length; i += 1) {
                                            if(investData.datasets[i].data.length==0){
                                                console.log('пусто');
                                        investData.datasets[i].data=[0,0,0,0,0,0];
                                        console.log(investData.datasets[i].data);
                                    }  
                                    else{
                                        console.log('массив не пустой')
                                    }
                                }
                                    let dealData = {
                                        labels: ['сент 20', 'окт 20', 'ноя 20', 'дек 20', 'янв 21', 'фев 21', 'мар 21', 'апр 21', 'май 21', 'июн 21'],
                                        datasets: [
                                            {
                                                label: '',
                                                data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                                labels: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                                                borderColor: '#80C2FF',
                                                backgroundColor: '#80C2FF',
                                                active: false,
                                            },
                                            {
                                                label: 'Pre-seed',
                                                borderColor: '#B7C2D7',
                                                backgroundColor: '#B7C2D7',
                                                data: [5, 31, 14, 18, 9, 30, 31, 14, 18, 9],
                                                fill: '-1'
                                            },
                                            {
                                                label: 'Seed',
                                                borderColor: '#F20EB5',
                                                backgroundColor: '#F20EB5',
                                                data: [4, 39, 41, 39, 33, 42, 39, 41, 39, 33],
                                                fill: '-1'
                                            },
                                            {
                                                label: 'Раунд A',
                                                borderColor: '#570EF2',
                                                backgroundColor: '#570EF2',
                                                data:[3, 19, 26, 28, 30, 19, 19, 26, 28, 30],
                                                fill: '-1'
                                            },
                                            {
                                                label: 'Раунд B',
                                                data: [1, 2, 5, 8, 7, 3, 2, 5, 8, 7],
                                                borderColor: '#80C2FF',
                                                backgroundColor: '#80C2FF',
                                                fill: '-1',
                                                borderWidth: 0,
                                            },
                                            {
                                                label: 'Раунд C+',
                                                borderColor: '#4D7EFC',
                                                backgroundColor: '#4D7EFC',
                                                data:[] /*[2, 9, 15, 8, 21, 7, 9, 15, 8, 21]*/,
                                                fill: '-1'
                                
                                            }
                                        ]
                                    };
                                    for (let i = 0; i < dealData.datasets.length; i += 1) {
                                            if(dealData.datasets[i].data.length==0){
                                                console.log('пусто');
                                                dealData.datasets[i].data=[0,0,0,0,0,0,0,0,0,0];
                                        console.log(dealData.datasets[i].data);
                                    }  
                                    else{
                                        console.log('массив не пустой');
                                    }
                                }
                                
                                    function addLastDataToLabels(chart) {
                                        chart.labels.unshift('first')
                                        chart.labels.push('last')
                                        for (i = 0; i < chart.datasets.length; i++) {
                                            let f = chart.datasets[i].data[0], l = chart.datasets[i].data[chart.datasets[i].data.length - 1]
                                            chart.datasets[i].data.unshift(f)
                                            chart.datasets[i].data.push(l)
                                        }
                                    }
                                
                                    addLastDataToLabels(dealData);
                                    addLastDataToLabels(investData);
                                
                                
                                    let dealDataClone = JSON.parse(JSON.stringify(dealData))
                                    let investDataClone = JSON.parse(JSON.stringify(investData))
                                
                                    function copyDataToLabels() {
                                        for (i = 0; i < dealData.datasets.length; i++) {
                                            dealData.datasets[i].labels = dealDataClone.datasets[i].data
                                        }
                                        for (i = 0; i < investData.datasets.length; i++) {
                                            investData.datasets[i].labels = investDataClone.datasets[i].data
                                        }
                                    }
                                
                                    function showMoreHeightMethod(chart) {
                                        chart.datasets.forEach(item => {
                                
                                            let delta = 0;
                                            for (let i = 0; i <= item.data.length; i++) {
                                                if (item.data[i]) {
                                                    item.data[i] = Math.abs(item.data[i]);
                                                    if ((item.data[i] <= 6) && (item.data[i] !== 0)) {
                                                        delta = delta + (11 - item.data[i]);
                                                        item.data[i] = 11;
                                
                                                    }
                                                    if ((item.data[i] > 6) & (item.data[i] <= 10) & (item.data[i] !== 0)) {
                                                        item.data[i] = 11;
                                
                                                    }
                                                }
                                
                                            }
                                        })
                                        for (let j = 0; j <= chart.datasets[0].data.length - 1; j++) {
                                            let newArr = []
                                            for (let i = 0; i <= chart.datasets.length - 1; i++) {
                                                newArr.push(chart.datasets[i].data[j])
                                            }
                                            let count = newArr.filter(elem => elem > 11).length;
                                            let summ = newArr.reduce((partialSum, a) => partialSum + a, 0);
                                            let maxEl = count > count ? Math.max.apply(0, newArr) : 0;
                                
                                            if (summ > 100) {
                                                chart.datasets.forEach(item => {
                                                    if ((item.data[j] > 11)) {
                                                        if ((summ - 100) / count < item.data[j]) {
                                                            item.data[j] = item.data[j] - (summ - 100) / count
                                                        }
                                                    }
                                                })
                                            }
                                        }
                                    }
                                
                                    copyDataToLabels();
                                    showMoreHeightMethod(dealData);
                                    showMoreHeightMethod(investData);
                                
                                
                                    const defaultLegendClickHandler = Chart.defaults.plugins.legend.onClick;
                                    const pieDoughnutLegendClickHandler = Chart.controllers.doughnut.overrides.plugins.legend.onClick;
                                
                                
                                    const chartLegend = {
                                        beforeInit: function (chart, args, options) {
                                            if (chart.canvas.id === "deal-chart") {
                                                const ul = document.createElement('ul');
                                                chart.data.labels.forEach((label, i) => {
                                                    if (typeof chart.data.datasets[i] == 'object' && chart.data.datasets[i].label != '') {
                                                        ul.innerHTML += `
                                                            <li  class="legend-item">
                                                              ${chart.data.datasets[i].label}
                                                              <span  style="background-color: ${chart.data.datasets[i].backgroundColor}">
                                                              </span>
                                                            </li>
                                                          `;
                                                    }
                                                });
                                
                                                return document.getElementById("finance-legend").appendChild(ul);
                                            }
                                
                                            return;
                                        },
                                    };
                                
                                    const chartLegendInvest = {
                                        beforeInit: function (chart, args, options) {
                                            if (chart.canvas.id === "invest-chart") {
                                                const ul = document.createElement('ul');
                                                chart.data.labels.forEach((label, i) => {
                                                    if (typeof chart.data.datasets[i] == 'object' && chart.data.datasets[i].label != '') {
                                                        ul.innerHTML += `
                                                            <li  class="legend-item-inv">
                                                              ${chart.data.datasets[i].label}
                                                              <span  style="background-color: ${chart.data.datasets[i].backgroundColor}">
                                                              </span>
                                                            </li>
                                                          `;
                                                    }
                                                });
                                
                                                return document.getElementById("invest-legend").appendChild(ul);
                                            }
                                
                                            return;
                                        },
                                    };
                                    const chartAreaBorder = {
                                        id: 'chartAreaBorder',
                                        beforeDraw(chart, args, options) {
                                            const {ctx, chartArea: {left, top, width, height}} = chart;
                                            ctx.save();
                                            ctx.strokeStyle = options.borderColor;
                                            ctx.lineWidth = options.borderWidth;
                                            ctx.setLineDash(options.borderDash || []);
                                            ctx.lineDashOffset = options.borderDashOffset;
                                            ctx.strokeRect(left, top, width, height);
                                            ctx.restore();
                                        }
                                    };
                                    var ctdx = document.getElementById('deal-chart').getContext('2d');
                                    var ivdx = document.getElementById('invest-chart').getContext('2d');
                                
                                    ctdx.height = 190;
                                    ctdx.width = 90 * dealData.labels.length;
                                    $('#deal-chart').css('width', 90 * dealData.labels.length);
                                
                                    $('#deal-chart').parents('.finance-grath__container').scrollLeft(9999999);
                                
                                    ivdx.height = 190;
                                    ivdx.width = 90 * investData.labels.length;
                                    $('#invest-chart').css('width', 90 * investData.labels.length);
                                
                                    $('#invest-chart').parents('.finance-grath__container').scrollLeft(9999999);
                                
                                    let mainOptions = {
                                        animation: false,
                                        responsive: true,
                                        maintainAspectRatio: false,
                                        scales: {
                                            x: {
                                                stacked: true,
                                                gridLines: {
                                                    color: "rgba(255, 255, 255, 1)",
                                                    z: 200,
                                                },
                                                grid: {
                                                    color: "rgba(255, 255, 255, 1)",
                                                    z: 200,
                                                },
                                                ticks: {
                                                    autoSkip: $(window).width() > 450 ? false : true,
                                                    maxRotation: $(window).width() > 450 ? 0 : 25,
                                                    minRotation: 0,
                                                    color: '#000000',
                                                    font: {
                                                        size: 10,
                                                        family: 'IBM Plex Sans',
                                                        weight: 'normal'
                                                    },
                                                    callback: function (val, index) {
                                                        return this.getLabelForValue(val) != 'last' && this.getLabelForValue(val) != 'first' ? this.getLabelForValue(val) : '';
                                                    },
                                                },
                                
                                            },
                                            y: {
                                                stacked: true,
                                                display: false,
                                                max: 100,
                                                grid: {
                                                    color: "rgba(255, 255, 255, 1)",
                                                    display: false
                                                },
                                                ticks: {
                                                    color: '#ff0000',
                                                    display: false,
                                                }
                                
                                            },
                                        },
                                        title: {
                                            display: false,
                                            text: ''
                                        },
                                        elements: {
                                            point: {
                                                radius: 0
                                            }
                                        },
                                        plugins: {
                                
                                            tooltip: {
                                                enabled: false
                                            },
                                            filler: {
                                                propagate: true
                                            },
                                            'samples-filler-analyser': {
                                                target: 'chart-analyser'
                                            },
                                            datalabels: {
                                                color: '#ffffff',
                                                align: '55',
                                                clamp: true,
                                                anchor: 'start',
                                                //backgroundColor:'#000000',
                                                offset: 4,
                                                font: {
                                                    family: 'Roboto',
                                                    size: '10',
                                                    weight: '500',
                                                },
                                                textAlign: 'end',
                                                //offset: 8,
                                                padding: {
                                                    top: 0,
                                                    left: 10,
                                                    bottom: 0,
                                                    right: 0
                                                },
                                                formatter: function (value, context) {
                                                    let len = context.dataset.labels.length - 1
                                                    return context.dataIndex != 0 && context.dataIndex != len && context.dataset.labels[context.dataIndex] != 0 ? context.dataset.labels[context.dataIndex] + '%' : ''
                                                }
                                            },
                                            legend: {
                                                position: "bottom",
                                                display: false
                                            },
                                        },
                                        interaction: {
                                            intersect: false,
                                        },
                                        //responsive: false,
                                    };
                                
                                
                                    const bindChartEvents = function (myChart, containerElement) {
                                        const legendItemSelector = ".legend-item";
                                
                                        const legendItems = [
                                            ...containerElement.querySelectorAll(legendItemSelector)
                                        ];
                                
                                        legendItems.forEach((item, i) => {
                                            item.addEventListener("click", (e) => {
                                                    if ($(e.target).hasClass('legend-item')) {
                                                        updateDataset($(e.target), i)
                                                    } else {
                                                        updateDataset($(e.target).parents('.legend-item'), i)
                                                    }
                                
                                                }
                                            );
                                        });
                                
                                        const updateDataset = (currentEl, index) => {
                                            const result = currentEl.hasClass('hidden');
                                            if (result === true) {
                                                myChart.show(index + 1);
                                                currentEl.removeClass("hidden");
                                            } else {
                                                myChart.hide(index + 1);
                                                currentEl.addClass("hidden");
                                            }
                                            myChart.update();
                                        };
                                    };
                                
                                    const bindChartEventsInv = function (myChart, containerElement) {
                                        const legendItemSelector = ".legend-item-inv";
                                
                                        const legendItems = [
                                            ...containerElement.querySelectorAll(legendItemSelector)
                                        ];
                                
                                        legendItems.forEach((item, i) => {
                                            item.addEventListener("click", (e) => {
                                                    if ($(e.target).hasClass('legend-item')) {
                                                        updateDataset($(e.target), i)
                                                    } else {
                                                        updateDataset($(e.target).parents('.legend-item'), i)
                                                    }
                                                }
                                            );
                                        });
                                
                                        const updateDataset = (currentEl, index) => {
                                            const result = currentEl.hasClass('hidden');
                                            if (result === true) {
                                                myChart.show(index + 1);
                                                currentEl.removeClass("hidden");
                                            } else {
                                                myChart.hide(index + 1);
                                                currentEl.addClass("hidden");
                                            }
                                            myChart.update();
                                        };
                                    };
                                
                                
                                    dtchart = new Chart(ctdx, {
                                        type: 'line',
                                        plugins: [ChartDataLabels, chartAreaBorder, chartLegend],
                                        //plugins: [ChartDataLabels, chartAreaBorder],
                                        data: dealData,
                                        options: mainOptions
                                    });
                                
                                    $('#deal-chart').parents('.finance-grath__container').scrollLeft(9999999);
                                    ivchart = new Chart(ivdx, {
                                        type: 'line',
                                        plugins: [ChartDataLabels, chartAreaBorder, chartLegendInvest],
                                        //plugins: [ChartDataLabels, chartAreaBorder],
                                        data: investData,
                                        options: mainOptions
                                    });
                                    $('#invest-chart').parents('.finance-grath__container').scrollLeft(9999999);
                                    bindChartEvents(dtchart, document);
                                    bindChartEventsInv(ivchart, document);
                                
                                    $('#invest-select').change(function () {
                                        investData = {
                                            labels: ["янв 17", "фев 17", "мар 17", "мар 18", "мар 30", "мар 71"],
                                            datasets: [
                                                {
                                                    label: '',
                                                    data: [0, 0, 0, 0, 0, 0],
                                                    borderColor: '#80C2FF',
                                                    backgroundColor: '#80C2FF',
                                                    active: false,
                                                },
                                                {
                                                    label: 'Pre-seed',
                                                    borderColor: '#B7C2D7',
                                                    backgroundColor: '#B7C2D7',
                                                    data: [78, 0, 56, 79, 56, 79],
                                                    fill: '-1'
                                
                                                },
                                                {
                                                    label: 'Seed',
                                                    borderColor: '#F20EB5',
                                                    backgroundColor: '#F20EB5',
                                                    data:[] /*[4, 3, 0, 3, 0, 3]*/,
                                                    fill: '-1',
                                                    borderWidth: 0,
                                                },
                                                {
                                                    label: 'Раунд A',
                                                    borderColor: '#570EF2',
                                                    backgroundColor: '#570EF2',
                                                    data: [0, 0, 8, 0, 8, 0],
                                                    fill: '-1',
                                                    borderWidth: 0,
                                                },
                                                {
                                                    label: 'Раунд B',
                                                    borderColor: '#80C2FF',
                                                    backgroundColor: '#80C2FF',
                                                    data: [18, 32, 14, 19, 14, 19],
                                                    fill: '-1'
                                                },
                                                {
                                                    label: 'Раунд C+',
                                                    borderColor: '#4D7EFC',
                                                    backgroundColor: '#4D7EFC',
                                                    data: [1, 64, 22, 2, 22, 2],
                                                    fill: '-1'
                                                }
                                            ]
                                        }
                                        for (let i = 0; i < investData.datasets.length; i += 1) {
                                            if(investData.datasets[i].data.length==0){
                                                console.log('пусто');
                                                investData.datasets[i].data=[0,0,0,0,0,0];
                                        console.log(investData.datasets[i].data);
                                    }  
                                    else{
                                        console.log('массив не пустой');
                                    }
                                }
                                        addLastDataToLabels(investData);
                                        investDataClone = JSON.parse(JSON.stringify(investData))
                                        for (i = 0; i < investData.datasets.length; i++) {
                                            investData.datasets[i].labels = investDataClone.datasets[i].data
                                        }
                                        showMoreHeightMethod(investData);
                                
                                        ivchart.data.labels = investData.labels;
                                        ivchart.data.datasets = investData.datasets;
                                        var ivdx = document.getElementById('invest-chart').getContext('2d');
                                        ivdx.height = 190;
                                        ivdx.width = 90 * investData.labels.length;
                                        $('#invest-chart').css('width', 90 * investData.labels.length);
                                        $('#invest-chart').css('height', 190);
                                        $('#invest-chart').parents('.finance-grath__container').scrollLeft(9999999);
                                        ivchart.update();
                                        ivchart.resize();
                                
                                    })
                                    $('#deal-select').change(function () {
                                        dealData = {
                                            labels: ["янв 17", "фев 17", "мар 17", "мар 18", "мар 30", "мар 71"],
                                            datasets: [
                                                {
                                                    label: '',
                                                    data: [0, 0, 0, 0, 0, 0],
                                                    borderColor: '#80C2FF',
                                                    backgroundColor: '#80C2FF',
                                                    active: false,
                                                },
                                                {
                                                    label: 'Pre-seed',
                                                    borderColor: '#B7C2D7',
                                                    backgroundColor: '#B7C2D7',
                                                    data: [79, 0, 56, 79, 56, 79],
                                                    fill: '-1'
                                
                                                },
                                                {
                                                    label: 'Seed',
                                                    borderColor: '#F20EB5',
                                                    backgroundColor: '#F20EB5',
                                                    data: [3, 3, 0, 3, 0, 3],
                                                    fill: '-1',
                                                    borderWidth: 0,
                                                },
                                                {
                                                    label: 'Раунд A',
                                                    borderColor: '#570EF2',
                                                    backgroundColor: '#570EF2',
                                                    data: [] /*[0, 0, 8, 0, 8, 0]*/,
                                                    fill: '-1',
                                                    borderWidth: 0,
                                                },
                                                {
                                                    label: 'Раунд B',
                                                    borderColor: '#80C2FF',
                                                    backgroundColor: '#80C2FF',
                                                    data: [19, 32, 14, 19, 14, 19],
                                                    fill: '-1'
                                                },
                                                {
                                                    label: 'Раунд C+',
                                                    borderColor: '#4D7EFC',
                                                    backgroundColor: '#4D7EFC',
                                                    data: [0, 64, 22, 2, 22, 2],
                                                    fill: '-1'
                                                }
                                            ]
                                        }
                                        for (let i = 0; i < dealData.datasets.length; i += 1) {
                                            if(dealData.datasets[i].data.length==0){
                                                console.log('пусто');
                                                dealData.datasets[i].data=[0,0,0,0,0,0];
                                        console.log(dealData.datasets[i].data);
                                    }  
                                    else{
                                        console.log('массив не пустой');
                                    }
                                }
                                        addLastDataToLabels(dealData);
                                        dealDataClone = JSON.parse(JSON.stringify(dealData))
                                        for (i = 0; i < dealData.datasets.length; i++) {
                                            dealData.datasets[i].labels = dealDataClone.datasets[i].data
                                        }
                                        showMoreHeightMethod(dealData);
                                
                                        dtchart.data.labels = dealData.labels;
                                        dtchart.data.datasets = dealData.datasets;
                                        var ctdx = document.getElementById('deal-chart').getContext('2d');
                                        ctdx.height = 190;
                                        ctdx.width = 90 * dealData.labels.length;
                                        $('#deal-chart').css('width', 90 * dealData.labels.length);
                                        $('#deal-chart').css('height', 190);
                                        $('#deal-chart').parents('.finance-grath__container').scrollLeft(9999999);
                                        dtchart.update();
                                        dtchart.resize();
                                
                                    })
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

        </div>
        <footer class="page__footer container-fluid">
            <div class="footer">
                <div class="row footer-desc">
                    <div class="logo-wrapper col-lg-2 col-md-4">
                        <a href="#" target="_blank">
                            <img src="static/img/content/deals/aim.svg" alt="">
                        </a>
                    </div>
                    <div class="menu-item col-lg-2 col-md-4">
                        <a href="#" class="menu-item-href" target="_blank">
                            <img src="static/img/content/deals/mik.svg" alt="">
                        </a>
                    </div>
                    <div class="menu-item col-lg-3 col-md-4">
                        <a href="#" class="menu-item-href" target="_blank">
                            <img src="static/img/content/deals/sg.svg" alt="">
                        </a>
                    </div>
                    <div class="menu-item footer-text offset-col-lg-1 col-lg-4 col-md-6">
                        <p>Нашли опечатку? Выделите текст и&nbsp;нажмите <span class="text-white text-nowrap">CTRL + ENTER</span>
                        </p>
                        <p>Нашли ошибку, есть вопросы или хотите добавить информацию в&nbsp;дэшборд, напишите нам <a href="mailto:research@develop.mos.ru">research@develop.mos.ru</a>
                        </p>
                    </div>
                </div>
                <div class="footer-mobile d-lg-none d-md-none d-sm-block">
                    <div class="footer-title">Полезные ссылки</div>
                    <div class="footer-href">
                        <a href="/">Венчурные инвестиции</a>
                        <a href="/exits/">Выходы</a>
                        <a href="/startups/">Таблица сделок</a>
                        <a href="/investments/">Направления инвестиций</a>
                        <a href="/startups/">ESG</a>
                        <a href="/startups/">Аналитические исследования</a>
                        <a href="/about/">О проекте</a>
                    </div>
                    <div class="footer-title">Контакты</div>
                    <div class="footer-href">
                        <a href="mailto:research@develop.mos.ru">research@develop.mos.ru</a>
                    </div>
                    <p>ГБУ «Агенство инноваций Москвы», 2022</p>
                </div>
            </div>
        </footer>


        <script src="static/js/separate-js/svg4everybody.min.js"></script>
        <script>
            svg4everybody();
        </script>

        <!-- Main scripts. You can replace it, but I recommend you to leave it here     -->
        <script src="static/js/main.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
    </body>

</html>
